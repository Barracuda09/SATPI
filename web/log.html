<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="assets/css/stylesheet.css">

<title>SAT>IP Log Page</title>

<script src="assets/js/menu.js"></script>
<script src="assets/js/loadxmldoc.js"></script>
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script>
	var stopScroll = 0;
	function buildcontent(xmlDoc) {
		var page = "";
		var logdata = xmlDoc.getElementsByTagName("log");
		if (stopScroll == 0) {
			var textarea = document.getElementById('txt');
			textarea.scrollTop = textarea.scrollHeight;
		}
		for (i = 0; i < logdata.length; i++) {
			timestamp = logdata[i].getElementsByTagName("timestamp")[0].childNodes[0].nodeValue;
			msg = logdata[i].getElementsByTagName("msg")[0].childNodes[0].nodeValue;
			prio = logdata[i].getElementsByTagName("prio")[0].childNodes[0].nodeValue;

			page +=  i;
			page += "&nbsp;&nbsp;";
			page +=  timestamp;
			page += "&nbsp;&nbsp;";
			page +=  prio;
			page += "&nbsp;&nbsp;";
			page +=  msg;
			page += "\n";
		}
		return page;
	}
	function updatePage() {
		loadXMLDoc("log.xml");
	}
	// function called when xml is loaded
	function xmlloaded(xml) {
		document.getElementById("txt").innerHTML = buildcontent(xml);
	}
	function scrollToBottom() {
		$('#txt').scrollTop($('#txt')[0].scrollHeight);
	}
	$("#txt").change(function() {
		scrollToBottom();
	});
</script>

</head>
<body>
<div id="menu"></div>
<div id="footer"></div>

<div class="container-fluid">
	<div class="start">
		<h3>Main Log Page</h3>
		<div id="content" class="log">
			<textarea id="txt" class="form-control logtext" onmouseover="stopScroll = 1" onmouseout="stopScroll = 0" readOnly></textarea>
		</div>
		<script>
			// make menu
			document.getElementById("menu").innerHTML = buildmenu();
			document.getElementById("footer").innerHTML = buildfooter();
			setMenuItemActive("log");

			// Call the ajax refresh each refresh_time seconds
			var refresh_time = 2000;
			updatePage();
			setInterval("updatePage()", refresh_time);
		</script>
	</div>
</div>

</body>
</html>
