<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="stylesheet.css">

<title>SAT>IP Config Page</title>

<script src="menu.js"></script>
<script src="loadxmldoc.js"></script>
<script src="postxmldoc.js"></script>
<script src="jquery.min.js"></script>
<script src="bootstrap.min.js"></script>
<script src="addtableentry.js"></script>
<script>
	var filename = "config.xml";
	var autoload = 1;
	var xmlLoaded;

	function addTableLineEntry(labelstring, xmlDoc, tagName) {
		var page = "";
		if (xmlDoc.getElementsByTagName(tagName).length != 0) {
			page += "<tr>";
			page += addTableLabel(labelstring);
			page += addTableEntry(xmlDoc, tagName, tagName);
			page += "<tr>";
		}
		return page;
	}

	function buildcontent(xmlDoc) {
		var length = 1;
		var page = "<table class=\"table table-bordered table-striped\">";

		page += "<tr class=\"separator\"><th colspan=\"" + length + 1  + "\">General</th></tr>";
		page += addTableLineEntry("SSDP Interval (sec)", xmlDoc, "input1");
		page += addTableLineEntry("Satip Channel list (m3u)", xmlDoc, "xsatipm3u");

		// check if OSCam part is there
		if (xmlDoc.getElementsByTagName("OSCamEnabled").length != 0) {
			page += "<tr class=\"separator\"><th colspan=\"" + length + 1  + "\">OSCam</th></tr>";
			page += addTableLineEntry("OSCam server Enabled", xmlDoc, "OSCamEnabled");
			page += addTableLineEntry("OSCam server name", xmlDoc, "OSCamServerName");
			page += addTableLineEntry("OSCam server IP", xmlDoc, "OSCamIP");
			page += addTableLineEntry("OSCam server PORT", xmlDoc, "OSCamPORT");
			page += addTableLineEntry("Rewrite PMT", xmlDoc, "RewritePMT");
		}

		page +=	 "</table><br>";
		return page;
	}
	function updatePage() {
		loadXMLDoc(filename);
	}
	// function called when xml is loaded
	function xmlloaded(xml) {
		if (autoload == 1) {
			xmlLoaded = xml;
			document.getElementById("content").innerHTML = buildcontent(xml);
		}
	}

</script>

</head>
<body>
<div id="menu"></div>

<div class="container-fluid">
	<div class="start">
		<h3>Main Configure Page</h3>
		<div class="table-responsive">
			<div id="content"></div>
			<script>
				// make menu
				document.getElementById("menu").innerHTML = buildmenu();
				setMenuItemActive("config");

				// Call the ajax refresh each refresh_time seconds
				var refresh_time = 3000;
				updatePage();
				setInterval("updatePage()", refresh_time);
			</script>
		</div>
	</div>
</div>
<div class="navbar navbar-default navbar-fixed-bottom">
	<div class="container">
		<p class="navbar-text pull-left">Copyright &#169; 2015 Marc Postema</p>
	</div>
</div>
</body>
</html>
